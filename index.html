<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>윤성이가 좋아하는 단어 테스트!</title>
<style>
  :root{
    --bg:#faf9ff; --card:#ffffff; --ink:#1f2937; --muted:#6b7280; --brand:#6d28d9;
    --brand2:#9333ea; --ok:#16a34a; --bad:#ef4444; --ring:rgba(109,40,217,.25);
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font-family: ui-rounded, system-ui, -apple-system, "Segoe UI", Roboto, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;}
  .wrap{max-width:920px;margin:0 auto;padding:16px;display:grid;gap:12px}
  header{display:flex;align-items:center;justify-content:space-between;gap:8px}
  h1{font-size: clamp(20px, 4vw, 28px);margin:0;font-weight:800;letter-spacing:-0.3px;background:linear-gradient(90deg,var(--brand),var(--brand2));-webkit-background-clip:text;color:transparent}
  .card{background:var(--card);border-radius:18px;box-shadow:0 8px 24px rgba(0,0,0,.06);padding:14px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .row > *{min-width:0}
  select, button, input[type="text"]{
    width:100%;padding:14px 13px;border-radius:14px;border:1px solid #e7e7ef;background:white;font-size:16px;
    outline:none;transition:.15s;box-shadow:0 0 0 0 var(--ring);
  }
  select:focus, input:focus{border-color:var(--brand);box-shadow:0 0 0 6px var(--ring)}
  button{background:linear-gradient(180deg,#7c3aed,#6d28d9);color:#fff;border:none;font-weight:700}
  button.ghost{background:#fff;color:var(--brand);border:1px solid #e6e0fb}
  button.alt{background:#111827}
  button:disabled{opacity:.6}
  .controls{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
  .controls3{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
  .qarea{display:grid;gap:10px;text-align:center}
  .tag{display:inline-flex;gap:6px;align-items:center;padding:6px 10px;border-radius:999px;background:#f1e9ff;color:#5b21b6;font-weight:700;font-size:12px}
  .q{font-size: clamp(20px,5.6vw,34px);font-weight:800;letter-spacing:-.3px;line-height:1.2;margin:6px 0}
  .sub{font-size:14px;color:var(--muted)}
  .choices{display:grid;grid-template-columns:1fr;gap:8px}
  .choice{padding:14px;border:1px solid #ebe9f7;border-radius:14px;background:#fff;text-align:left}
  .choice.correct{border-color:rgba(22,163,74,.4);background:#ecfdf5}
  .choice.wrong{border-color:rgba(239,68,68,.4);background:#fef2f2}
  .answerbox{display:flex;gap:8px}
  .answerbox input{flex:1}
  .stat{display:flex;gap:10px;flex-wrap:wrap;align-items:center;font-size:13px;color:var(--muted)}
  .pill{background:#f4f4f8;border:1px solid #ececf5;border-radius:999px;padding:6px 10px}
  .score{font-weight:800;color:#111827}
  .footer{display:flex;gap:8px;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-top:6px}
  .sm{font-size:12px;color:var(--muted)}
  .bigbtn{padding:16px;font-size:18px;border-radius:16px}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .hidden{display:none !important}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>윤성이가 좋아하는 단어 테스트!</h1>
    <button class="ghost" id="btnReset">진행률 초기화</button>
  </header>

  <section class="card">
    <div class="row">
      <div>
        <label class="sm">날짜 선택</label>
        <select id="daySelect"></select>
      </div>
      <div>
        <label class="sm">모드</label>
        <select id="modeSelect">
          <option value="eng2kor">영→한 (뜻 맞히기)</option>
          <option value="kor2eng">한→영 (스펠 쓰기)</option>
        </select>
      </div>
    </div>
    <div class="grid2" style="margin-top:8px">
      <div>
        <label class="sm">출제 방식</label>
        <select id="styleSelect">
          <option value="mc">객관식(선택)</option>
          <option value="input">주관식(직접 입력)</option>
        </select>
      </div>
      <div>
        <label class="sm">학습 범위</label>
        <select id="poolSelect">
          <option value="all">전체</option>
          <option value="wrong">오답만</option>
          <option value="new">미학습</option>
        </select>
      </div>
    </div>
    <div class="controls" style="margin-top:8px">
      <button id="btnStart" class="bigbtn">시작하기</button>
      <button id="btnSpeak" class="ghost bigbtn">발음 듣기 🔊</button>
    </div>
  </section>

  <section class="card qarea hidden" id="quizArea">
    <div class="tag" id="tagInfo">Day ? • 문제 ?/?</div>
    <div class="q" id="question">문제 영역</div>
    <div class="sub" id="hint"></div>

    <div id="mcArea" class="choices"></div>

    <div id="inputArea" class="answerbox hidden">
      <input id="answerInput" type="text" inputmode="latin" autocomplete="off" placeholder="여기에 정답을 입력하세요" />
      <button id="btnCheck">확인</button>
    </div>

    <div class="footer">
      <div class="stat">
        <span class="pill">정답: <b class="score" id="correctCnt">0</b></span>
        <span class="pill">오답: <b class="score" id="wrongCnt">0</b></span>
        <span class="pill">연속정답: <b class="score" id="streak">0</b></span>
      </div>
      <div class="controls3">
        <button id="btnSkip" class="ghost">건너뛰기</button>
        <button id="btnAgain" class="ghost">오답노트</button>
        <button id="btnNext" class="">다음 ▶</button>
      </div>
    </div>
  </section>

  <section class="card">
    <div class="sm">
      • **영→한** 모드에서는 영어 발음을 들을 수 있어요.  
      • **한→영** 모드에서는 철자까지 정확히 써야 합니다(대소문자 무시, 쉼표·괄호는 무시).  
      • 오답은 자동 저장되어 “오답만”으로 복습할 수 있어요.
    </div>
  </section>
</div>

<script>
/** -----------------------------
 *  1) 날짜별 단어 데이터
 *  key: "Day 7 (8/12)" 형식
 *  eng: 영어 표기, kor: 한국어 의미(여러 뜻은 콤마로 구분)
 *--------------------------------*/
const WORDS = {
"Day 7 (8/12)":[
  {eng:"light a flame", kor:"불을 지피다"},
  {eng:"arson", kor:"방화"},
  {eng:"on purpose", kor:"고의로, 일부러"},
  {eng:"heatwave", kor:"열기, 열선"},
  {eng:"destroy", kor:"파괴하다"},
  {eng:"history", kor:"역사"},
  {eng:"eastern", kor:"동쪽에 위치한"},
  {eng:"reach", kor:"~에 이르다, 닿다"},
  {eng:"luckily", kor:"다행스럽게도"},
  {eng:"accident", kor:"사고, 재해"},
  {eng:"cigarette", kor:"담배"},
  {eng:"car crash", kor:"자동차 충돌사고"},
  {eng:"knock down", kor:"때려 부수다"},
  {eng:"electrical line", kor:"전선"},
  {eng:"spark", kor:"불꽃, 불똥, 불꽃을 일으키다"},
],
"Day 8 (8/13)":[
  {eng:"controlled burn", kor:"통제된 연소"},
  {eng:"satellite", kor:"(인공) 위성, 위성(장치)"},
  {eng:"put out fires", kor:"불을 끄다"},
  {eng:"chemical", kor:"화학의"},
  {eng:"equipment", kor:"장비"},
  {eng:"tower", kor:"탑, 송신탑"},
  {eng:"look for", kor:"~을 찾다"},
  {eng:"call for", kor:"~을 필요로 하다"},
  {eng:"match", kor:"성냥"},
  {eng:"effect", kor:"영향, 결과, 효과"},
  {eng:"cost", kor:"비용, 비용이 들다"},
  {eng:"breathe", kor:"호흡하다, 숨을 쉬다"},
  {eng:"look after", kor:"~을 보살피다, ~에 주의하다"},
  {eng:"expert", kor:"전문가"},
  {eng:"prevent", kor:"막다, 예방하다"},
],
"Day 9 (8/14)":[
  {eng:"lighter", kor:"(담배) 라이터"},
  {eng:"fire extinguisher", kor:"소화기"},
  {eng:"emergency", kor:"비상(사태)"},
  {eng:"evacuate", kor:"대피시키다"},
  {eng:"order", kor:"명령"},
  {eng:"ash", kor:"재, 잿더미"},
  {eng:"jewelry", kor:"보석류"},
  {eng:"envelope", kor:"봉투"},
  {eng:"tore", kor:"(tear의 과거) 찢었다"},
  {eng:"invitation", kor:"초대(초청)장"},
  {eng:"a grand ball", kor:"성대한 무도회"},
  {eng:"palace", kor:"궁전, 왕실"},
  {eng:"instead of", kor:"~대신에"},
  {eng:"opportunity", kor:"기회"},
  {eng:"irritated", kor:"짜증이 난, 화난"},
],
"Day 10 (8/18)":[
  {eng:"glance", kor:"흘깃보다, 흘깃 봄"},
  {eng:"impatiently", kor:"조마조마하게, 조급하게"},
  {eng:"stammer", kor:"말을 더듬다, 말더듬기"},
  {eng:"calm", kor:"침착한, 차분한"},
  {eng:"voice", kor:"목소리"},
  {eng:"franc", kor:"프랑 (화폐단위)"},
  {eng:"grow pale", kor:"파랗게 질리다"},
  {eng:"savings", kor:"저축"},
  {eng:"anxious", kor:"불안해하는"},
  {eng:"annoy", kor:"짜증나게하다"},
  {eng:"stylish", kor:"유행을 따르는, 멋진, 우아한"},
  {eng:"humiliating", kor:"굴욕스러운"},
  {eng:"lend", kor:"빌려주다"},
  {eng:"wardrobe", kor:"옷장"},
  {eng:"Certainly", kor:"그럼요, 물론이지요"},
],
"Day 11 (8/19)":[
  {eng:"present", kor:"참석한"},
  {eng:"feel a sense of joy", kor:"희열감을 느끼다"},
  {eng:"elegant", kor:"우아한, 품격있는"},
  {eng:"midnight", kor:"자정, 한밤중"},
  {eng:"contrast", kor:"대조하다, 대조"},
  {eng:"catch a cold", kor:"감기 들다"},
  {eng:"cab", kor:"택시"},
  {eng:"despair", kor:"절망, 절망하다"},
  {eng:"whole", kor:"전체의"},
  {eng:"route", kor:"길, 노선"},
  {eng:"completely", kor:"완전히"},
  {eng:"overwhelmed", kor:"압도된"},
  {eng:"reward", kor:"보상, 보상하다"},
  {eng:"fear", kor:"두려움, 공포"},
  {eng:"hollow", kor:"(속이) 빈"},
],
"Day 12 (8/20)":[
  {eng:"clasp", kor:"(꽉) 움켜쥐다, (꽉) 껴안다"},
  {eng:"mend", kor:"수리하다, 고치다"},
  {eng:"make a plan", kor:"계획을 짜다"},
  {eng:"lose hope", kor:"희망을 잃다"},
  {eng:"possess", kor:"소유하다, 지니다"},
  {eng:"borrow", kor:"빌리다"},
  {eng:"collect", kor:"모으다"},
  {eng:"frightened", kor:"겁먹은, 무서워하는"},
  {eng:"whenever", kor:"~할 때는 언제든지, ~할 때마다"},
  {eng:"from then on", kor:"그때부터"},
  {eng:"detect", kor:"발견하다, 감지하다"},
  {eng:"substitution", kor:"대체"},
  {eng:"thief", kor:"도둑"},
  {eng:"tough", kor:"힘든, 어려운"},
  {eng:"complain", kor:"불평하다"},
],
"Day 13 (8/21)":[
  {eng:"accept", kor:"받아들이다"},
  {eng:"dreadful", kor:"끔찍한, 지독한"},
  {eng:"debt", kor:"빚, 부채"},
  {eng:"dainty", kor:"앙증맞은, 조심스러운"},
  {eng:"bargain", kor:"싸게 사는 물건, 협의, 흥정"},
  {eng:"absolutely", kor:"틀림없이"},
  {eng:"interest", kor:"이자"},
  {eng:"admire", kor:"존경하다, 칭찬하다"},
  {eng:"strange", kor:"이상한, 낯선"},
  {eng:"refresh", kor:"생기를 되찾게하다"},
  {eng:"charming", kor:"매력적인, 멋진"},
  {eng:"astonish", kor:"깜짝 놀라게 하다"},
  {eng:"greet", kor:"환영하다"},
  {eng:"utter", kor:"(말을) 하다"},
  {eng:"poverty", kor:"가난"},
],
"Day 14 (8/25)":[
  {eng:"outbreak", kor:"발생, 발발"},
  {eng:"pandemic", kor:"전국(전 세계적인) 유행병"},
  {eng:"be ill", kor:"몸이 편치 않다"},
  {eng:"at the same time", kor:"그와 동시에"},
  {eng:"illness", kor:"병, 아픔"},
  {eng:"from person to person", kor:"사람에서 사람으로"},
  {eng:"serious", kor:"심각한"},
  {eng:"break out", kor:"발생하다, 발발하다"},
  {eng:"affect", kor:"영향을 미치다"},
  {eng:"tiny", kor:"아주 작은"},
  {eng:"organism", kor:"유기체, (극도로 작은) 생물체"},
  {eng:"microscope", kor:"현미경"},
  {eng:"bacteria", kor:"박테리아, 세균"},
  {eng:"are made of", kor:"~으로 만들어지다"},
  {eng:"cell", kor:"세포"},
],
"Day 15 (8/26)":[
  {eng:"digest", kor:"소화하다"},
  {eng:"infection", kor:"감염"},
  {eng:"enter", kor:"들어가다"},
  {eng:"stick to", kor:"~에 달라붙다, 고수하다"},
  {eng:"copy", kor:"복사, 복사하다"},
  {eng:"virus", kor:"바이러스"},
  {eng:"common", kor:"흔한"},
  {eng:"the flu", kor:"독감"},
  {eng:"human", kor:"인간"},
  {eng:"dangerous", kor:"위험한"},
  {eng:"develop", kor:"성장하다, 발전하다"},
  {eng:"Europe", kor:"유럽"},
  {eng:"everywhere", kor:"모든 곳, 어디나"},
  {eng:"Plague", kor:"전염병"},
  {eng:"European", kor:"유럽의"},
],
"Day 16 (8/27)":[
  {eng:"continue", kor:"계속하다"},
  {eng:"flea", kor:"벼룩"},
  {eng:"rat", kor:"쥐"},
  {eng:"carry", kor:"(병을) 옮기다"},
  {eng:"was filled with", kor:"~으로 가득찼다"},
  {eng:"herb", kor:"허브, 약초"},
  {eng:"ability", kor:"능력"},
  {eng:"infectious", kor:"전염되는"},
  {eng:"sneezing", kor:"재채기"},
  {eng:"door handle", kor:"손잡이"},
  {eng:"type", kor:"유형"},
  {eng:"cough", kor:"기침하다, 기침"},
  {eng:"anymore", kor:"더이상"},
  {eng:"create", kor:"창조하다"},
  {eng:"vaccine", kor:"백신"},
],
"Day 17 (8/28)":[
  {eng:"medicine", kor:"약, 의약"},
  {eng:"less", kor:"덜"},
  {eng:"healthy", kor:"건강한"},
  {eng:"exercise", kor:"운동하다"},
  {eng:"simple", kor:"간단한, 단순한"},
  {eng:"step", kor:"단계"},
  {eng:"protect", kor:"보호하다"},
  {eng:"cover", kor:"덮다, 가리다"},
  {eng:"keep a distance", kor:"거리를 유지하다"},
  {eng:"follow", kor:"따르다"},
  {eng:"direction", kor:"지시"},
  {eng:"make sure", kor:"확실하게 하다"},
  {eng:"on average", kor:"평균적으로"},
  {eng:"on stage", kor:"무대에서"},
  {eng:"stream", kor:"스트리밍하다"},
],
"Day 18 (8/29)":[
  {eng:"dance to music", kor:"음악에 맞춰 춤추다"},
  {eng:"attend", kor:"참석하다"},
  {eng:"write lyrics", kor:"가사를 쓰다"},
  {eng:"held", kor:"(축제를) 열었다"},
  {eng:"music competition", kor:"음악경연대회"},
  {eng:"fantastic", kor:"엄청난, 굉장한"},
  {eng:"senior", kor:"나이 든 사람, 노인"},
  {eng:"unity", kor:"통합, 일치"},
  {eng:"convince", kor:"납득시키다"},
  {eng:"nothing", kor:"아무것도 (아니다)"},
  {eng:"beat", kor:"이기다"},
  {eng:"get a chance", kor:"기회를 얻다"},
  {eng:"regret", kor:"후회하다"},
  {eng:"hit a home run", kor:"홈런을 치다"},
  {eng:"commit", kor:"저지르다, 범하다"},
],
};

/** ------------ 상태/유틸 -------------- */
const $ = sel => document.querySelector(sel);
const daySelect = $('#daySelect'), modeSelect = $('#modeSelect'), styleSelect = $('#styleSelect');
const poolSelect = $('#poolSelect');
const quizArea = $('#quizArea'), tagInfo = $('#tagInfo'), q = $('#question'), hint = $('#hint');
const mcArea = $('#mcArea'), inputArea = $('#inputArea'), answerInput = $('#answerInput');
const btnCheck = $('#btnCheck'), btnNext = $('#btnNext'), btnSkip = $('#btnSkip'), btnAgain = $('#btnAgain');
const btnStart = $('#btnStart'), btnSpeak = $('#btnSpeak'), btnReset = $('#btnReset');
const correctCnt = $('#correctCnt'), wrongCnt = $('#wrongCnt'), streakEl = $('#streak');

const DAYS = Object.keys(WORDS);
DAYS.forEach(d => {
  const opt = document.createElement('option'); opt.value = d; opt.textContent = d; daySelect.appendChild(opt);
});
daySelect.value = DAYS[0];

let pool = [], idx = 0, correct=0, wrong=0, streak=0, answered=false;
const KEY = "yoon_vocab_progress_v1";

/** 로컬 진행률 */
function loadProg(){
  try{ return JSON.parse(localStorage.getItem(KEY) || "{}"); }catch(e){ return {}; }
}
function saveProg(data){ localStorage.setItem(KEY, JSON.stringify(data)); }
function markWrong(day, eng){
  const prog = loadProg(); prog[day]??={done:[], wrong:[]};
  if(!prog[day].wrong.includes(eng)) prog[day].wrong.push(eng);
  saveProg(prog);
}
function markRight(day, eng){
  const prog = loadProg(); prog[day]??={done:[], wrong:[]};
  if(!prog[day].done.includes(eng)) prog[day].done.push(eng);
  prog[day].wrong = prog[day].wrong.filter(x=>x!==eng);
  saveProg(prog);
}

/** 문자열 정규화(한→영 입력 채점 시 괄호/쉼표/공백/대소문자 무시) */
function norm(s){
  return s.toLowerCase().replace(/[()\,]/g,' ').replace(/\s+/g,' ').trim();
}
/** 셔플 */
function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }
/** 보기 생성 */
function buildChoices(correctKor, dayList){
  const pool = shuffle(dayList.filter(x=>x.kor!==correctKor)).slice(0,3).map(x=>x.kor);
  pool.push(correctKor); return shuffle(pool);
}

/** 문제 시작 */
btnStart.addEventListener('click', start);
btnReset.addEventListener('click', ()=>{
  if(confirm('저장된 진행률과 오답노트를 초기화할까요?')){
    localStorage.removeItem(KEY); alert('초기화 완료!');
  }
});

function start(){
  const day = daySelect.value;
  const mode = modeSelect.value;
  const style = styleSelect.value;
  const list = WORDS[day].slice();
  const prog = loadProg()[day] || {done:[], wrong:[]};

  if(poolSelect.value==="wrong" && prog.wrong.length){
    pool = list.filter(x=>prog.wrong.includes(x.eng));
  }else if(poolSelect.value==="new" && prog.done.length){
    pool = list.filter(x=>!prog.done.includes(x.eng));
    if(pool.length===0){ alert('모든 문제를 학습했습니다! “전체” 또는 “오답만”을 선택해 보세요.'); return; }
  }else{
    pool = list;
  }

  shuffle(pool);
  idx=0; correct=0; wrong=0; streak=0;
  correctCnt.textContent=0; wrongCnt.textContent=0; streakEl.textContent=0;

  quizArea.classList.remove('hidden');
  updateUI();
  answerInput.value="";
  answerInput.focus();
  window.scrollTo({top:0,behavior:'smooth'});
}

/** 음성 */
btnSpeak.addEventListener('click', ()=>{
  const day = daySelect.value;
  if(!quizArea.classList.contains('hidden')){
    speak(pool[idx].eng);
  }else{
    speak("Yoonsung Vocabulary Test");
  }
});
function speak(text){
  try{
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'en-US'; u.rate = 0.95;
    speechSynthesis.cancel(); speechSynthesis.speak(u);
  }catch(e){}
}

/** UI 갱신 */
function updateUI(){
  const day = daySelect.value, mode = modeSelect.value, style = styleSelect.value;
  const item = pool[idx];
  tagInfo.textContent = `${day} • 문제 ${idx+1}/${pool.length}`;

  if(mode==="eng2kor"){
    q.textContent = item.eng;
    hint.textContent = "한국어 뜻을 맞혀보세요";
    btnSpeak.disabled=false;
  }else{
    q.textContent = item.kor;
    hint.textContent = "영어 철자를 써보세요";
    btnSpeak.disabled=true; // 한국어 힌트에선 발음 비활성
  }

  answered=false;
  mcArea.innerHTML="";
  inputArea.classList.add('hidden');

  if(style==="mc" || mode==="eng2kor"){
    // 객관식 (한글 보기) — 한→영 모드라도 기본은 입력이 더 좋아서, 한→영 선택은 style=mc에서만 사용
    const dayList = WORDS[day];
    const choices = (mode==="eng2kor")
      ? buildChoices(item.kor, dayList)
      : shuffle([item.eng, ...shuffle(dayList.filter(x=>x.eng!==item.eng)).slice(0,3).map(x=>x.eng)]);
    mcArea.classList.remove('hidden');
    choices.forEach(text=>{
      const b = document.createElement('button');
      b.className="choice";
      b.textContent=text;
      b.addEventListener('click', ()=>grade(text));
      mcArea.appendChild(b);
    });
  }else{
    mcArea.classList.add('hidden');
    inputArea.classList.remove('hidden');
    answerInput.value="";
    answerInput.placeholder = (mode==="kor2eng") ? "예) fire extinguisher" : "예) 불을 지피다";
    setTimeout(()=>answerInput.focus(),100);
  }
}

/** 채점 */
function grade(user){
  if(answered) return; answered=true;
  const mode = modeSelect.value;
  const day = daySelect.value;
  const item = pool[idx];

  let ok=false, expected="", userShow="";
  if(mode==="eng2kor"){
    expected = item.kor;
    userShow = user ?? answerInput.value;
    ok = norm(userShow)===norm(expected);
  }else{
    expected = item.eng;
    userShow = user ?? answerInput.value;
    ok = norm(userShow)===norm(expected);
  }

  if(user===undefined){
    // 입력형에서 버튼으로 채점 누른 경우
  }

  if(mcArea.children.length){
    [...mcArea.children].forEach(btn=>{
      const t = btn.textContent;
      if(norm(t)===norm(expected)) btn.classList.add('correct');
      if(user && norm(t)===norm(user) && norm(user)!==norm(expected)) btn.classList.add('wrong');
      btn.disabled=true;
    });
  }

  if(ok){
    correct++; streak++;
    correctCnt.textContent=correct; streakEl.textContent=streak;
    markRight(day, item.eng);
  }else{
    wrong++; streak=0;
    wrongCnt.textContent=wrong; streakEl.textContent=streak;
    markWrong(day, item.eng);
    // 정답 안내
    const tip = document.createElement('div');
    tip.className="sub";
    tip.style.color="var(--bad)";
    tip.style.fontWeight="700";
    tip.style.marginTop="4px";
    tip.textContent = `정답: ${expected}  (${item.eng})`;
    document.querySelector('.qarea').appendChild(tip);
    setTimeout(()=>tip.remove(), 2500);
    if(!mcArea.children.length){
      answerInput.select();
    }
  }
}

/** 버튼 동작 */
btnCheck.addEventListener('click', ()=>grade());
answerInput.addEventListener('keydown', e=>{
  if(e.key==='Enter'){ grade(); }
});
btnNext.addEventListener('click', ()=>{
  if(idx < pool.length-1){ idx++; updateUI(); }
  else { finish(); }
});
btnSkip.addEventListener('click', ()=>{
  if(idx < pool.length-1){ idx++; updateUI(); }
  else { finish(); }
});
btnAgain.addEventListener('click', ()=>{
  poolSelect.value="wrong"; start();
});

function finish(){
  alert(`완료! 정답 ${correct}, 오답 ${wrong}`);
  quizArea.classList.add('hidden');
}

/** 처음 로딩 시 UI 정리 */
styleSelect.addEventListener('change', ()=>{
  // 한→영이면 기본 주관식 추천
  if(modeSelect.value==="kor2eng" && styleSelect.value==="mc"){
    // 허용하되 그대로 둠
  }
});
</script>
</body>
</html>
